// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.17;

import "../../Contracts/BLS.sol";
import "../../lib/forge-std/src/Test.sol";

contract BLSTest is Test {
    BLS public bls;

    function setUp() public virtual {
        bls = new BLS();
    }

    function test1Signature() public {
        callVerification(1);
    }

    function test2Signatures() public {
        callVerification(2);
    }

    function test10Signatures() public {
        callVerification(10);
    }

    function test50Signatures() public {
        callVerification(50);
    }

    function test100Signatures() public {
        callVerification(100);
    }

    function test200Signatures() public {
        callVerification(200);
    }

    function callVerification(uint256 iterations) public {
        uint256[2][5] memory points_g1 = [
            [
                4732500246076266494184282090774606989935310339956125703553588050065105269449,
                17680088654892913246817622267030318133161076660043605649300612920347752169327
            ],
            [
                1655578660422496991839058780452835616766416333598975400769190111973908174329,
                16334665185251989719101735311683947808779079810183866863232955457422711503726
            ],
            [
                2158316458707131911275071143380994217088898089732797680826870887849729267568,
                6971679878213161407063319038605172967137805123573869578911796847049132490312
            ],
            [
                8576261527351857515426555337599102506220793565224054175246633932523471367165,
                771009138047006070038011277566814502400921301438466400405133292350688559367
            ],
            [
                19480461969932257876878170265959836028049445961789963553890279675190509712626,
                11888220534482210570021111341257508711127644460450041892325658710707756835077
            ]
        ];
        uint256[4] memory aggregated_g2 = [
            16107724620565268486113547920743305981763768734799061141659526210098944987773,
            21323868166032824971863760930365980572558633517350687381808651811396734488576,
            17191993868799457080073200884011434371028798818038581218726308557027693549224,
            16433815207607945400951820806215735047636210418732248243253706275566161432461
        ];
        bytes memory data = hex"abcd";
        uint256[2] memory signature = [
            18537545182909561107417233428375807555079264596439827079160049762049286502693,
            2329905116482683045662882115211057579645363719330061225100993299826377394399
        ];
        bls.multiVerifier(
            points_g1,
            aggregated_g2,
            data,
            signature,
            iterations
        );
    }
}
